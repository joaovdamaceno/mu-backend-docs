"use strict";(self.webpackChunkmu_backend_docs=self.webpackChunkmu_backend_docs||[]).push([[933],{6015:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>r,default:()=>p,frontMatter:()=>d,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"tests/junit","title":"Testes autom\xe1ticos (JUnit)","description":"Onde ficam","source":"@site/docs/tests/junit.md","sourceDirName":"tests","slug":"/tests/junit","permalink":"/mu-backend-docs/tests/junit","draft":false,"unlisted":false,"editUrl":"https://github.com/joaovdamaceno/mu-backend-docs/tree/main/docs/tests/junit.md","tags":[],"version":"current","frontMatter":{"title":"Testes autom\xe1ticos (JUnit)"},"sidebar":"docsSidebar","previous":{"title":"Como testar se est\xe1 funcionando","permalink":"/mu-backend-docs/tests/overview"},"next":{"title":"Deploy no GitHub Pages","permalink":"/mu-backend-docs/deploy/github-pages"}}');var i=n(4848),t=n(8453);const d={title:"Testes autom\xe1ticos (JUnit)"},r=void 0,a={},c=[{value:"Onde ficam",id:"onde-ficam",level:2},{value:"Exemplo de testes \xfateis (ideia)",id:"exemplo-de-testes-\xfateis-ideia",level:2},{value:"Dica pr\xe1tica",id:"dica-pr\xe1tica",level:2},{value:"Exemplo completo (Spring Boot)",id:"exemplo-completo-spring-boot",level:2},{value:"Rodar um teste espec\xedfico",id:"rodar-um-teste-espec\xedfico",level:2},{value:"Seed e limpeza de dados",id:"seed-e-limpeza-de-dados",level:2},{value:"Diagn\xf3sticos comuns",id:"diagn\xf3sticos-comuns",level:2}];function l(e){const s={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h2,{id:"onde-ficam",children:"Onde ficam"}),"\n",(0,i.jsx)(s.p,{children:"No padr\xe3o Maven:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"src/test/java/..."})}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"exemplo-de-testes-\xfateis-ideia",children:"Exemplo de testes \xfateis (ideia)"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"POST /api/posts"})," cria e retorna 201/200"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"GET /api/posts"})," lista e retorna array"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"GET /api/posts/{id}"})," retorna 200 quando existe e 404 quando n\xe3o existe"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"POST /api/registrations"}),":","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"retorna 200/201"}),"\n",(0,i.jsx)(s.li,{children:"falha em email duplicado (unique constraint) com 409/400 dependendo do handler"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"dica-pr\xe1tica",children:"Dica pr\xe1tica"}),"\n",(0,i.jsx)(s.p,{children:"Se voc\xea est\xe1 com pressa, foque em:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"1 teste de \u201csubiu e responde\u201d"}),"\n",(0,i.jsx)(s.li,{children:"1 teste de \u201csalva no banco\u201d"}),"\n",(0,i.jsx)(s.li,{children:"1 teste de \u201clista\u201d"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"E deixe os testes mais completos pra depois."}),"\n",(0,i.jsx)(s.h2,{id:"exemplo-completo-spring-boot",children:"Exemplo completo (Spring Boot)"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-java",children:'@SpringBootTest\n@AutoConfigureMockMvc\nclass PostControllerTest {\n\n    @Autowired\n    private MockMvc mockMvc;\n\n    @Autowired\n    private PostRepository postRepository;\n\n    @BeforeEach\n    void setup() {\n        postRepository.deleteAll();\n        postRepository.save(new Post("hello", "world"));\n    }\n\n    @AfterEach\n    void teardown() {\n        postRepository.deleteAll();\n    }\n\n    @Test\n    void shouldListPosts() throws Exception {\n        mockMvc.perform(get("/api/posts"))\n            .andExpect(status().isOk())\n            .andExpect(jsonPath("$.length()", greaterThanOrEqualTo(1)));\n    }\n}\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.code,{children:"@BeforeEach"}),"/",(0,i.jsx)(s.code,{children:"@AfterEach"})," para preparar e limpar o estado do banco."]}),"\n",(0,i.jsxs)(s.li,{children:["Troque ",(0,i.jsx)(s.code,{children:"PostRepository"}),"/",(0,i.jsx)(s.code,{children:"/api/posts"})," pelos seus reposit\xf3rios/endpoints reais."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"rodar-um-teste-espec\xedfico",children:"Rodar um teste espec\xedfico"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Maven: ",(0,i.jsx)(s.code,{children:"mvn -Dtest=PostControllerTest#shouldListPosts test"})]}),"\n",(0,i.jsxs)(s.li,{children:["Gradle: ",(0,i.jsx)(s.code,{children:"./gradlew test --tests PostControllerTest.shouldListPosts"})]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"seed-e-limpeza-de-dados",children:"Seed e limpeza de dados"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Para cen\xe1rios de ponta a ponta, suba o backend, crie os dados via endpoints REST (ex.: ",(0,i.jsx)(s.code,{children:"POST /api/posts"}),") usando ",(0,i.jsx)(s.a,{href:"/mu-backend-docs/api/endpoints",children:"API \u2192 Endpoints"})," e ",(0,i.jsx)(s.a,{href:"/mu-backend-docs/api/postman",children:"API \u2192 Postman"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Em testes automatizados, voc\xea pode usar reposit\xf3rios ou scripts SQL (",(0,i.jsx)(s.code,{children:"@Sql"}),") para popular tabelas antes do teste e limpar no ",(0,i.jsx)(s.code,{children:"@AfterEach"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Se precisar rodar migra\xe7\xf5es antes da su\xedte, garanta que o profile de teste executa Flyway/Liquibase (",(0,i.jsx)(s.code,{children:"spring.flyway.enabled=true"}),")."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"diagn\xf3sticos-comuns",children:"Diagn\xf3sticos comuns"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Banco ausente ou inacess\xedvel"}),": verifique se ",(0,i.jsx)(s.code,{children:"DB_URL"}),", ",(0,i.jsx)(s.code,{children:"DB_USERNAME"}),", ",(0,i.jsx)(s.code,{children:"DB_PASSWORD"})," est\xe3o exportadas e o container/servi\xe7o est\xe1 de p\xe9."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Migra\xe7\xf5es n\xe3o aplicadas"}),": rode ",(0,i.jsx)(s.code,{children:"mvn -Dflyway.configFiles=... flyway:migrate"})," ou reinicie o app para aplicar Flyway/Liquibase antes de testar."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Dados de seed faltando"}),": use os endpoints documentados em ",(0,i.jsx)(s.a,{href:"/mu-backend-docs/api/endpoints",children:"API \u2192 Endpoints"})," para inserir registros base (ex.: usu\xe1rios, posts) antes de validar."]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>r});var o=n(6540);const i={},t=o.createContext(i);function d(e){const s=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),o.createElement(t.Provider,{value:s},e.children)}}}]);